<div class="blog-post">
  <div class="profile">
    <app-profile />
  </div>
  <div *ngFor="let post of posts">
    <div class="post-div">
      <h2>{{ post.author }}</h2>
      <h2>{{ post.title }}</h2>
      <p>{{ post.content }}</p>

      <button (click)="onShowComment(post.id!)">
        Comment {{ comments[post.id!]?.length || 0 }}
      </button>
      <div class="actions" *ngIf="post.authorId">
        <button (click)="onShowPostForm(post.id)">Edit</button>
        <button (click)="onDeletePost(post.id)">Delete</button>
      </div>
      <button (click)="onShowCommentForm(post.id)">Add Comment</button>
    </div>

    <div *ngIf="showCommentForm[post.id]">
      <app-create-comment [postId]="post.id" />
    </div>
    <div *ngIf="showPostForm && currentPostId === post.id">
      <app-create-post [postId]="post.id" (closeForm)="onClosePostForm()" />
    </div>

    <div *ngIf="showComments[post.id!]">
      <h3>Comments:</h3>
      <p>Post ID: {{ post.id }}</p>
      <p>Comments for this post: {{ comments[post.id!]?.length || 0 }}</p>

      <ul
        *ngIf="
          comments[post.id] && comments[post.id].length > 0;
          else noComments
        "
      >
        <div *ngFor="let comment of comments[post.id]">
          <p>{{ comment.author }}</p>
          <p>{{ comment.content }}</p>
        </div>
      </ul>

      <ng-template #noComments>
        <p>No comments for this post.</p>
      </ng-template>
    </div>
  </div>
</div>
